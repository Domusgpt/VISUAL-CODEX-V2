<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Three-Phase Animation Demo - Visual Codex</title>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

  <style>
    :root {
      --primary: #7B3FF2;
      --secondary: #4FC3F7;
      --bg-dark: #0A0A0B;
      --glass-bg: rgba(15, 15, 17, 0.8);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html, body {
      background: var(--bg-dark);
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      overflow-x: hidden;
    }

    /* Animated Background */
    .bg-gradient {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(circle at 30% 40%, rgba(123, 63, 242, 0.2) 0%, transparent 50%),
        radial-gradient(circle at 70% 60%, rgba(79, 195, 247, 0.15) 0%, transparent 50%);
      z-index: -1;
    }

    /* Phase Indicator */
    .phase-indicator {
      position: fixed;
      top: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 16px;
      z-index: 1000;
      padding: 12px 20px;
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .indicator {
      padding: 10px 16px;
      text-align: center;
      border-radius: 8px;
      background: rgba(255,255,255,0.05);
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.5px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      color: rgba(255,255,255,0.5);
    }

    .indicator.active {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: #fff;
      box-shadow: 0 4px 20px rgba(123, 63, 242, 0.4);
    }

    .indicator span {
      display: block;
      font-size: 9px;
      opacity: 0.7;
      margin-top: 4px;
    }

    /* Progress Ring */
    .progress-ring {
      position: fixed;
      bottom: 30px;
      right: 30px;
      width: 70px;
      height: 70px;
      z-index: 1000;
    }

    .progress-ring circle {
      fill: none;
      stroke-width: 4;
    }

    .progress-ring .bg {
      stroke: rgba(255,255,255,0.1);
    }

    .progress-ring .progress {
      stroke: url(#gradient);
      stroke-linecap: round;
      stroke-dasharray: 220;
      stroke-dashoffset: 220;
      transform: rotate(-90deg);
      transform-origin: center;
      transition: stroke-dashoffset 0.1s;
    }

    .progress-text {
      position: fixed;
      bottom: 55px;
      right: 52px;
      font-size: 12px;
      font-weight: 600;
      z-index: 1001;
    }

    /* Pinned Section */
    .pin-section {
      height: 400vh; /* 4x viewport for scroll distance */
      position: relative;
    }

    .pin-container {
      height: 100vh;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      perspective: 1200px;
    }

    /* The Card */
    .phase-card {
      width: min(450px, 90vw);
      padding: 50px 40px;
      background: var(--glass-bg);
      backdrop-filter: blur(30px);
      border: 1px solid rgba(255,255,255,0.15);
      border-radius: 28px;
      text-align: center;
      transform-style: preserve-3d;
      will-change: transform, opacity;
    }

    .phase-card h2 {
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      margin-bottom: 20px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .phase-card p {
      color: rgba(255,255,255,0.7);
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 24px;
    }

    .phase-label {
      display: inline-block;
      padding: 8px 20px;
      background: rgba(123, 63, 242, 0.2);
      border: 1px solid rgba(123, 63, 242, 0.4);
      border-radius: 20px;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 1px;
      color: var(--secondary);
    }

    /* Glow effect during LOCK phase */
    .card-glow {
      position: absolute;
      top: 50%;
      left: 50%;
      width: 500px;
      height: 500px;
      transform: translate(-50%, -50%);
      background: radial-gradient(circle, rgba(123, 63, 242, 0.3) 0%, transparent 70%);
      opacity: 0;
      pointer-events: none;
      z-index: -1;
    }

    /* Info */
    .info {
      position: fixed;
      bottom: 30px;
      left: 30px;
      font-size: 13px;
      color: rgba(255,255,255,0.4);
      z-index: 1000;
      line-height: 1.6;
    }

    .info strong {
      color: var(--primary);
    }

    /* Intro and Outro sections */
    .intro-section, .outro-section {
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 40px;
    }

    .intro-section h1 {
      font-size: clamp(2rem, 6vw, 3.5rem);
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 16px;
    }

    .intro-section p, .outro-section p {
      color: rgba(255,255,255,0.6);
      font-size: 1.2rem;
      max-width: 500px;
    }

    .outro-section {
      flex-direction: column;
      gap: 20px;
    }

    .outro-section .checkmark {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 40px;
    }
  </style>
</head>
<body>
  <div class="bg-gradient"></div>

  <!-- Phase Indicator -->
  <div class="phase-indicator">
    <div class="indicator" id="ind-entrance">ENTRANCE<span>0-30%</span></div>
    <div class="indicator" id="ind-lock">LOCK<span>30-70%</span></div>
    <div class="indicator" id="ind-exit">EXIT<span>70-100%</span></div>
  </div>

  <!-- Progress Ring -->
  <svg class="progress-ring" viewBox="0 0 80 80">
    <defs>
      <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="100%">
        <stop offset="0%" style="stop-color:#7B3FF2"/>
        <stop offset="100%" style="stop-color:#4FC3F7"/>
      </linearGradient>
    </defs>
    <circle class="bg" cx="40" cy="40" r="35"/>
    <circle class="progress" id="progress-circle" cx="40" cy="40" r="35"/>
  </svg>
  <div class="progress-text" id="progress-text">0%</div>

  <!-- Intro -->
  <section class="intro-section">
    <div>
      <h1>Three-Phase Animation</h1>
      <p>Scroll down to experience the ENTRANCE → LOCK → EXIT lifecycle pattern</p>
    </div>
  </section>

  <!-- Pinned Animation Section -->
  <section class="pin-section">
    <div class="pin-container" id="pin-container">
      <div class="card-glow" id="card-glow"></div>
      <div class="phase-card" id="card">
        <h2 id="card-title">Phase Card</h2>
        <p id="card-desc">Watch as this card moves through three distinct phases of animation</p>
        <div class="phase-label" id="phase-label">WAITING</div>
      </div>
    </div>
  </section>

  <!-- Outro -->
  <section class="outro-section">
    <div class="checkmark">✓</div>
    <h2 style="font-size: 2rem; color: #fff;">Animation Complete</h2>
    <p>You've experienced the full three-phase lifecycle. Scroll back up to replay!</p>
  </section>

  <div class="info">
    <strong>Pattern 09:</strong> Three-Phase Animation<br>
    Visual Codex - GSAP Scroll Choreography
  </div>

  <script>
    gsap.registerPlugin(ScrollTrigger);

    const card = document.getElementById('card');
    const cardGlow = document.getElementById('card-glow');
    const progressCircle = document.getElementById('progress-circle');
    const progressText = document.getElementById('progress-text');
    const cardTitle = document.getElementById('card-title');
    const cardDesc = document.getElementById('card-desc');
    const phaseLabel = document.getElementById('phase-label');

    const indicators = {
      entrance: document.getElementById('ind-entrance'),
      lock: document.getElementById('ind-lock'),
      exit: document.getElementById('ind-exit')
    };

    function setActivePhase(phase, label) {
      Object.values(indicators).forEach(ind => ind.classList.remove('active'));
      if (indicators[phase]) indicators[phase].classList.add('active');
      phaseLabel.textContent = label;
    }

    // Create the pinned timeline
    const tl = gsap.timeline({
      scrollTrigger: {
        trigger: ".pin-section",
        start: "top top",
        end: "bottom bottom",
        pin: ".pin-container",
        scrub: 0.8,
        onUpdate: (self) => {
          const p = self.progress;

          // Update progress ring
          const offset = 220 - (p * 220);
          progressCircle.style.strokeDashoffset = offset;
          progressText.textContent = Math.round(p * 100) + '%';

          // Update phase indicator and label
          if (p < 0.3) {
            setActivePhase('entrance', 'ENTERING');
            cardTitle.textContent = 'Emerging...';
            cardDesc.textContent = 'The card enters from the void, rotating into view';
          } else if (p < 0.7) {
            setActivePhase('lock', 'LOCKED');
            cardTitle.textContent = 'Center Stage';
            cardDesc.textContent = 'Content is front and center with full user attention';
          } else {
            setActivePhase('exit', 'EXITING');
            cardTitle.textContent = 'Departing...';
            cardDesc.textContent = 'The card gracefully exits, making room for what\'s next';
          }
        }
      }
    });

    // ====== PHASE 1: ENTRANCE (0% - 30%) ======
    // Card emerges from below with rotation
    tl.fromTo(card,
      {
        y: 200,
        rotateX: -30,
        scale: 0.7,
        opacity: 0
      },
      {
        y: 0,
        rotateX: 0,
        scale: 1,
        opacity: 1,
        duration: 0.3,
        ease: "power2.out"
      }
    );

    // ====== PHASE 2: LOCK (30% - 70%) ======
    // Subtle breathing and glow - content stays visible
    tl.to(cardGlow, {
      opacity: 1,
      scale: 1.2,
      duration: 0.1,
      ease: "sine.inOut"
    })
    .to(card, {
      scale: 1.02,
      boxShadow: "0 20px 60px rgba(123, 63, 242, 0.3)",
      duration: 0.1,
      ease: "sine.inOut"
    })
    .to(card, {
      scale: 1,
      duration: 0.1,
      ease: "sine.inOut"
    })
    .to(card, {
      scale: 1.01,
      duration: 0.1,
      ease: "sine.inOut"
    })
    .to(card, {
      scale: 1,
      duration: 0.1,
      ease: "sine.inOut"
    });

    // ====== PHASE 3: EXIT (70% - 100%) ======
    // Card exits upward with rotation
    tl.to(cardGlow, {
      opacity: 0,
      duration: 0.05
    }, "-=0.05")
    .to(card, {
      y: -200,
      rotateX: 20,
      scale: 0.7,
      opacity: 0,
      duration: 0.3,
      ease: "power2.in"
    });

    // Intro fade on scroll
    gsap.to('.intro-section', {
      opacity: 0,
      y: -100,
      scrollTrigger: {
        trigger: '.intro-section',
        start: 'top top',
        end: 'bottom top',
        scrub: true
      }
    });
  </script>

  <!--
  Visual Codex Pattern: Three-Phase Animation
  Category: GSAP Scroll Choreography
  Pattern: 09 - ENTRANCE → LOCK → EXIT

  Key Improvements:
  - Proper pinning keeps card in viewport
  - Y-axis animation (not Z) for visible movement
  - Subtle scale changes during LOCK phase
  - Dynamic content updates per phase
  - Smooth transitions between phases

  Author: Paul Phillips
  © 2025 Clear Seas Solutions LLC
  -->
</body>
</html>
