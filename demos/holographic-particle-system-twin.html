<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obsidian Particle Field - Twin Variant</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: radial-gradient(circle at 30% 20%, #060b16 0%, #000108 60%);
            overflow: hidden;
            font-family: 'Courier New', monospace;
            color: #d8f5ff;
        }

        .particle-system {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .particle {
            position: absolute;
            width: 5px;
            height: 5px;
            background: radial-gradient(circle, var(--color) 0%, transparent 70%);
            border-radius: 50%;
            opacity: 0;
            transform: translate3d(0, 0, 0) scale(0.4);
            will-change: transform, opacity;
        }

        .container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1000px;
        }

        .holographic-card {
            position: relative;
            width: 320px;
            height: 420px;
            margin: 18px;
            backdrop-filter: blur(18px);
            background: linear-gradient(135deg, rgba(80, 150, 255, 0.14), rgba(180, 100, 255, 0.1));
            border: 1px solid rgba(120, 200, 255, 0.35);
            border-radius: 22px;
            box-shadow: 0 18px 40px rgba(12, 40, 80, 0.4), 0 0 30px rgba(80, 180, 255, 0.24);
            transition: transform 0.4s ease, box-shadow 0.4s ease;
            overflow: hidden;
            cursor: pointer;
        }

        .holographic-card::before {
            content: '';
            position: absolute;
            top: -60%;
            left: -60%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 35%, rgba(160, 220, 255, 0.16) 50%, transparent 65%);
            transform: rotate(45deg);
            opacity: 0;
        }

        .holographic-card:hover::before {
            opacity: 1;
            animation: sweep 0.7s ease;
        }

        @keyframes sweep {
            0% { transform: translateX(-80%) translateY(-80%) rotate(45deg); }
            100% { transform: translateX(80%) translateY(80%) rotate(45deg); }
        }

        .holographic-card:hover {
            transform: translateY(-12px) rotateX(-6deg) rotateY(5deg);
            box-shadow: 0 26px 60px rgba(20, 60, 120, 0.55), 0 0 50px rgba(90, 200, 255, 0.36);
        }

        .card-content {
            padding: 34px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .card-title {
            font-size: 24px;
            color: #7ee8ff;
            text-shadow: 0 0 18px rgba(126, 232, 255, 0.7);
            letter-spacing: 3px;
            margin-bottom: 18px;
        }

        .card-description {
            color: rgba(216, 245, 255, 0.82);
            font-size: 15px;
            line-height: 1.6;
            text-shadow: 0 0 8px rgba(140, 210, 255, 0.3);
        }

        .moire-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.08;
            z-index: 2;
            background:
                repeating-linear-gradient(0deg, transparent, transparent 6px, rgba(180, 100, 255, 0.16) 6px, rgba(180, 100, 255, 0.16) 12px),
                repeating-linear-gradient(90deg, transparent, transparent 6px, rgba(90, 220, 255, 0.18) 6px, rgba(90, 220, 255, 0.18) 12px);
            animation: moireShift 12s linear infinite;
        }

        @keyframes moireShift {
            0% { transform: translate(0, 0); }
            100% { transform: translate(14px, 14px); }
        }
    </style>
</head>
<body>
    <div class="particle-system" id="particleSystem"></div>
    <div class="moire-overlay"></div>
        <button class="control-btn" onclick="toggleParticles()">Toggle Flux</button>
        <button class="control-btn" onclick="cycleEmitter()">Cycle Pattern</button>
        <button class="control-btn" onclick="changeLayout()">Shift Layout</button>
        <button class="control-btn" onclick="toggleMoire()">Moire Overlay</button>
        <button class="control-btn" onclick="randomizeColors()">Shift Palette</button>
        <div class="control-status" id="emitterStatus">Emitter: Vertical Stream</div>
    </div>

    <div class="container">
        <div class="holographic-card">
            <div class="card-content">
                <h2 class="card-title">Obsidian Field</h2>
                <p class="card-description">Twin codex rendition of the holographic field with indigo atmospherics.</p>
            </div>
        </div>
        <div class="holographic-card">
            <div class="card-content">
                <h2 class="card-title">Particle Lattice</h2>
                <p class="card-description">Complex lattice interplay between vertical flux and radial bursts.</p>
            </div>
        </div>
        <div class="holographic-card">
            <div class="card-content">
                <h2 class="card-title">Glass Halo</h2>
                <p class="card-description">Translucent overlays infused with teal and violet energy.</p>
            </div>
        </div>
    </div>

    <script>
        const particleSystem = document.getElementById('particleSystem');

        class ParticleController {
            constructor(root) {
                this.root = root;
                this.particles = new Set();
                this.modes = ['vertical', 'spiral', 'pulse'];
                this.modeIndex = 0;
                this.palettes = [
                    ['#7ee8ff', '#b695ff', '#f8b4ff', '#7cfef0', '#ffe6a7'],
                    ['#55f0c1', '#7bd9ff', '#d696ff', '#fbf5c6', '#8df7ff'],
                    ['#ffc857', '#00f5d4', '#5c7aff', '#f96d80', '#ffcbf2']
                ];
                this.paletteIndex = 0;
                this.pointer = { x: 0.5, y: 0.5 };
                this.isRunning = true;
                this.spawnAccumulator = 0;
                this.lastTimestamp = performance.now();
                this.angleCursor = 0;
                this.update = this.update.bind(this);
                requestAnimationFrame(this.update);
            }

            currentMode() { return this.modes[this.modeIndex]; }
            currentPalette() { return this.palettes[this.paletteIndex]; }
            randomColor() {
                const palette = this.currentPalette();
                return palette[Math.floor(Math.random() * palette.length)];
            }

            spawnParticle() {
                if (this.particles.size > 260) return;

                const el = document.createElement('div');
                el.className = 'particle';
                el.style.setProperty('--color', this.randomColor());
                this.root.appendChild(el);

                const particle = {
                    el,
                    life: Math.random() * 200,
                    maxLife: 3200 + Math.random() * 2200,
                    x: 0,
                    y: 0,
                    vx: 0,
                    vy: 0,
                    scale: 0.45 + Math.random() * 0.9
                };

                const width = window.innerWidth;
                const height = window.innerHeight;
                const pointerX = this.pointer.x * width;
                const pointerY = this.pointer.y * height;

                switch (this.currentMode()) {
                    case 'vertical':
                        particle.x = Math.random() * width;
                        particle.y = height + 30;
                        particle.vx = (Math.random() - 0.5) * 70;
                        particle.vy = -(80 + Math.random() * 120);
                        particle.maxLife = 5200 + Math.random() * 1600;
                        break;
                    case 'spiral':
                        const radius = 60 + Math.random() * 150;
                        const angle = this.angleCursor;
                        this.angleCursor += 0.32;
                        particle.x = width / 2 + Math.cos(angle) * radius;
                        particle.y = height / 2 + Math.sin(angle) * radius;
                        const tangent = angle + Math.PI / 2;
                        const speed = 90 + Math.random() * 95;
                        particle.vx = Math.cos(tangent) * speed;
                        particle.vy = Math.sin(tangent) * speed;
                        particle.maxLife = 4400 + Math.random() * 1200;
                        break;
                    case 'pulse':
                        const emissionAngle = Math.random() * Math.PI * 2;
                        const emissionRadius = 14 + Math.random() * 48;
                        particle.x = pointerX + Math.cos(emissionAngle) * emissionRadius;
                        particle.y = pointerY + Math.sin(emissionAngle) * emissionRadius;
                        const burstSpeed = 150 + Math.random() * 160;
                        particle.vx = Math.cos(emissionAngle) * burstSpeed;
                        particle.vy = Math.sin(emissionAngle) * burstSpeed;
                        particle.maxLife = 2100 + Math.random() * 1000;
                        break;
                }

                this.particles.add(particle);
            }

            advanceParticle(particle, delta) {
                particle.life += delta;
                const progress = particle.life / particle.maxLife;

                particle.x += particle.vx * (delta / 1000);
                particle.y += particle.vy * (delta / 1000);

                if (this.currentMode() === 'vertical') {
                    particle.x += Math.sin(particle.life / 380) * 12;
                }

                if (this.currentMode() === 'spiral') {
                    particle.vx *= 0.992;
                    particle.vy *= 0.992;
                }

                const fadeIn = Math.min(1, progress / 0.2);
                const fadeOut = 1 - Math.max(0, (progress - 0.7) / 0.3);
                const opacity = Math.max(0, Math.min(1, fadeIn * fadeOut));

                const influenceX = (this.pointer.x - 0.5) * 36;
                const influenceY = (this.pointer.y - 0.5) * 36;

                particle.el.style.opacity = opacity;
                particle.el.style.transform = `translate3d(${particle.x + influenceX}px, ${particle.y + influenceY}px, 0) scale(${particle.scale})`;

                if (
                    particle.life > particle.maxLife ||
                    particle.x < -220 || particle.x > window.innerWidth + 220 ||
                    particle.y < -220 || particle.y > window.innerHeight + 220
                ) {
                    this.root.removeChild(particle.el);
                    this.particles.delete(particle);
                }
            }

            update(timestamp) {
                if (!this.isRunning) {
                    this.lastTimestamp = timestamp;
                    requestAnimationFrame(this.update);
                    return;
                }

                const delta = timestamp - this.lastTimestamp;
                this.lastTimestamp = timestamp;
                this.spawnAccumulator += delta;

                const mode = this.currentMode();
                const spawnInterval = mode === 'pulse' ? 80 : mode === 'spiral' ? 70 : 110;

                while (this.spawnAccumulator > spawnInterval) {
                    this.spawnAccumulator -= spawnInterval;
                    this.spawnParticle();
                }

                this.particles.forEach(particle => this.advanceParticle(particle, delta));
                requestAnimationFrame(this.update);
            }

            toggle() {
                this.isRunning = !this.isRunning;
                this.root.style.opacity = this.isRunning ? '1' : '0';
                if (this.isRunning) {
                    this.lastTimestamp = performance.now();
                }
                return this.isRunning;
            }

            cycleMode() {
                this.modeIndex = (this.modeIndex + 1) % this.modes.length;
                this.angleCursor = 0;
                this.spawnAccumulator = 0;
                return this.currentMode();
            }

            shiftPalette() {
                this.paletteIndex = (this.paletteIndex + 1) % this.palettes.length;
            }

            setPointer(x, y) {
                this.pointer.x = Math.max(0, Math.min(1, x));
                this.pointer.y = Math.max(0, Math.min(1, y));
            }
        }

        const particleController = new ParticleController(particleSystem);

        function formatEmitter(mode) {
            const titles = {
                vertical: 'Vertical Stream',
                spiral: 'Spiral Glyph',
                pulse: 'Pulse Burst'
            };
            return `Emitter: ${titles[mode]}${particleController.isRunning ? '' : ' (Paused)'}`;
        }

        function updateEmitterStatus(mode) {
            const statusEl = document.getElementById('emitterStatus');
            if (statusEl) {
                statusEl.textContent = formatEmitter(mode);
            }
        }

        updateEmitterStatus(particleController.currentMode());
        for (let i = 0; i < 90; i++) {
            particleController.spawnParticle();
        }

        document.addEventListener('mousemove', (e) => {
            const x = e.clientX / window.innerWidth - 0.5;
            const y = e.clientY / window.innerHeight - 0.5;

            particleController.setPointer(x + 0.5, y + 0.5);

            document.querySelectorAll('.holographic-card').forEach(card => {
                const rotateY = x * 12;
                const rotateX = -y * 12;
                const translateZ = Math.abs(x * y) * 60;
                card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${translateZ}px)`;
            });
        });

        function toggleParticles() {
            particleController.toggle();
            updateEmitterStatus(particleController.currentMode());
        }

        function cycleEmitter() {
            const mode = particleController.cycleMode();
            updateEmitterStatus(mode);
        }

        function changeLayout() {
            const container = document.querySelector('.container');
            const layouts = ['row', 'column', 'row-reverse'];
            const currentLayout = container.style.flexDirection || 'row';
            const nextIndex = (layouts.indexOf(currentLayout) + 1) % layouts.length;
            container.style.flexDirection = layouts[nextIndex];
        }

        function toggleMoire() {
            const moire = document.querySelector('.moire-overlay');
            moire.style.opacity = moire.style.opacity === '0' ? '0.08' : '0';
        }

        function randomizeColors() {
            particleController.shiftPalette();
            document.querySelectorAll('.holographic-card').forEach(card => {
                const hue = Math.random() * 360;
                card.style.filter = `hue-rotate(${hue}deg)`;
            });
        }

        document.querySelectorAll('.holographic-card').forEach(card => {
            card.addEventListener('click', () => {
                card.style.animation = 'pulse 0.6s ease';
                setTimeout(() => card.style.animation = '', 600);
            });
        });

        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% { transform: scale(1); }
                40% { transform: scale(1.08); }
                100% { transform: scale(1); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
